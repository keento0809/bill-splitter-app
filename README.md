# 割り勘アプリ (Bill Splitter)

**Walica風の割り勘計算アプリ** - 旅行やイベントの費用を最小限の取引回数で清算

## ✨ 主な機能

### 💰 清算機能
- **最適化アルゴリズム**: 最小取引回数での清算計算
- **リアルタイム計算**: 支払い記録の変更に応じて即座に再計算
- **端数処理**: 10円・100円・1000円単位での調整
- **部分参加対応**: 特定メンバーの除外・途中参加

### 👥 グループ管理
- **登録不要**: ブラウザですぐに利用開始
- **URL共有**: グループリンクでメンバー招待
- **メンバー管理**: 追加・編集・削除・有効化/無効化

### 💳 支払い記録
- **詳細記録**: 「誰が」「いくら」「何に対して」支払ったか
- **参加者選択**: 支払いごとの参加者指定
- **履歴管理**: 支払い記録の編集・削除

### 📱 ユーザビリティ
- **レスポンシブデザイン**: スマートフォン・タブレット・PC対応
- **PWA対応**: オフライン利用・ホーム画面追加可能
- **データ永続化**: ブラウザローカルストレージで保存

## 🚀 技術スタック

- **Frontend**: React 19 + TypeScript 5
- **スタイリング**: Tailwind CSS 3
- **ビルドツール**: Vite 7
- **状態管理**: React Hooks (最小限のグローバル状態)
- **ルーティング**: React Router 6
- **テスト**: Vitest + Testing Library + Playwright
- **PWA**: Workbox (Service Worker)

## 📦 インストール・セットアップ

### 必要条件
- Node.js 18.0.0以上
- npm 9.0.0以上

### セットアップ手順

```bash
# リポジトリクローン
git clone [repository-url]
cd bill-splitter

# 依存関係インストール
npm install

# 開発サーバー起動
npm run dev
```

開発サーバーが `http://localhost:5173` で起動します。

## 🛠️ 利用可能なスクリプト

### 開発
```bash
npm run dev          # 開発サーバー起動
npm run build        # プロダクションビルド
npm run preview      # ビルド結果プレビュー
npm run lint         # ESLintでコードチェック
```

### テスト
```bash
npm run test         # ユニットテスト実行 (watch mode)
npm run test:run     # ユニットテスト実行 (一回のみ)
npm run test:e2e     # E2Eテスト実行
npm run test:e2e:ui  # E2EテストUI実行
```

### パフォーマンス分析
```bash
npm run build:analyze  # バンドルサイズ分析
npm run perf          # パフォーマンス測定
```

## 🏗️ プロジェクト構造

```
src/
├── components/          # UIコンポーネント
│   ├── common/         # 共通コンポーネント
│   │   ├── Button.tsx
│   │   ├── Input.tsx
│   │   ├── Modal.tsx
│   │   ├── Loading.tsx
│   │   └── VirtualizedList.tsx
│   └── sections/       # セクションコンポーネント
│       ├── MemberSection.tsx
│       ├── PaymentSection.tsx
│       └── CalculationSection.tsx
├── pages/              # ページコンポーネント
│   ├── Home.tsx        # ホームページ
│   └── Group.tsx       # グループページ
├── services/           # サービス層
│   └── storage.ts      # localStorage操作
├── utils/              # ユーティリティ
│   ├── calculation.ts  # 清算計算ロジック
│   ├── helpers.ts      # ヘルパー関数
│   └── memo.ts         # メモ化機能
├── types/              # TypeScript型定義
│   └── index.d.ts
└── test/               # テスト設定
    └── setup.ts
```

## 💡 使用方法

### 1. グループ作成
1. ホームページでグループ名を入力
2. 「グループを作成」をクリック
3. 生成されたURLを仲間に共有

### 2. メンバー追加
1. 「メンバー追加」でメンバー名を入力
2. 参加者全員を登録

### 3. 支払い記録
1. 「支払い追加」で詳細を入力
   - 金額
   - 支払い内容
   - 支払者
   - 参加者選択
2. 複数の支払いを記録

### 4. 清算確認
- リアルタイムで清算結果を表示
- 最小取引回数での清算方法を提案
- 個人収支も確認可能

## 🔧 設定・カスタマイズ

### 端数処理設定
- 10円単位、100円単位、1000円単位から選択可能
- グループ設定で変更

### PWA設定
- `vite.config.ts`の`VitePWA`設定で調整
- マニフェスト、Service Worker、キャッシュ戦略

## 🧪 テスト

### ユニットテスト
- **計算ロジック**: 清算アルゴリズムの正確性
- **コンポーネント**: UIコンポーネントの動作
- **カバレッジ**: 主要機能の90%以上

### E2Eテスト
- **完全フロー**: グループ作成〜清算まで
- **エラーハンドリング**: 無効入力の処理
- **レスポンシブ**: モバイル環境での動作
- **URL共有**: 機能の動作確認

## ⚡ パフォーマンス最適化

### バンドル最適化
- **コード分割**: チャンク単位での最適化
- **Tree Shaking**: 未使用コードの除去
- **圧縮**: Terserによる最適化

### 実行時最適化
- **メモ化**: 計算結果のキャッシュ（LRU、TTL: 5分）
- **React最適化**: 適切なuseCallback/useMemo使用
- **仮想化**: 大量データ対応

### パフォーマンス指標
- **初期ロード**: 23.16 kB (gzip)
- **メインJS**: 6.61 kB (gzip)
- **改善率**: 初期ロード89%削減達成

## 🌐 PWA機能

### オフライン対応
- Service Workerによるキャッシュ
- ネットワーク切断時も利用可能

### インストール
- ホーム画面への追加対応
- ネイティブアプリライクな体験

### 自動更新
- アプリ更新の自動検知・適用

## 🤝 開発・貢献

### 開発ガイドライン
- TypeScript必須
- ESLint/Prettierに従ったコード
- テストカバレッジ90%以上維持
- コミット前にlint・test実行

### アーキテクチャ原則
- **最小限の状態管理**: グローバル状態の回避
- **コンポーネント分離**: 責任の明確化
- **型安全性**: TypeScriptの活用
- **テスタビリティ**: ユニット・E2Eテスト

## 📊 パフォーマンス分析

バンドル分析結果は `npm run build:analyze` で確認可能。

### 最適化結果
| 項目 | サイズ | gzip | 説明 |
|------|--------|------|------|
| React Vendor | 210.76 kB | 67.51 kB | React関連ライブラリ |
| Components | 17.30 kB | 4.88 kB | UIコンポーネント |
| Utils | 3.79 kB | 1.57 kB | 計算・ヘルパー |
| Main | 6.61 kB | 2.41 kB | アプリケーションコア |

## 📄 ライセンス

MIT License

## 🔗 関連リンク

- [設計ドキュメント](./.tmp/design.md)
- [要件定義](./.tmp/requirements.md)
- [タスク分解](./.tmp/tasks.md)
- [パフォーマンスレポート](./.tmp/performance-report.md)

---

**開発者**: Claude Code
**最終更新**: 2025年1月27日